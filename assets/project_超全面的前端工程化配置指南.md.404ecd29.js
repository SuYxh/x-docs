import{o as e,c as o,e as t}from"./app.c30441d1.js";const n='{"title":"å‰ç«¯å·¥ç¨‹åŒ–é…ç½®æŒ‡å—","description":"","frontmatter":{},"headers":[{"level":2,"title":"å‰ç«¯å·¥ç¨‹åŒ–é…ç½®æŒ‡å—","slug":"å‰ç«¯å·¥ç¨‹åŒ–é…ç½®æŒ‡å—"},{"level":2,"title":"ç¤ºä¾‹","slug":"ç¤ºä¾‹"},{"level":2,"title":"åˆå§‹åŒ–","slug":"åˆå§‹åŒ–"},{"level":2,"title":"é…ç½®","slug":"é…ç½®"},{"level":3,"title":"Typescript","slug":"typescript"},{"level":3,"title":"Eslint & Prettier","slug":"eslint-prettier"},{"level":3,"title":"Husky","slug":"husky"},{"level":3,"title":"Commitlint","slug":"commitlint"},{"level":3,"title":"Jest","slug":"jest"},{"level":3,"title":"Github Actions","slug":"github-actions"},{"level":2,"title":"ç»“è¯­","slug":"ç»“è¯­"}],"relativePath":"project/è¶…å…¨é¢çš„å‰ç«¯å·¥ç¨‹åŒ–é…ç½®æŒ‡å—.md","lastUpdated":1661330957047}',c={},d=[t('<p><img src="https://qn.huat.xyz/mac/20220716185129.png" alt=""></p><p><strong>ç¨‹åºå‘˜æˆé•¿æŒ‡åŒ—</strong></p><p>ä¸“æ³¨ Node.js æŠ€æœ¯æ ˆåˆ†äº«ï¼Œä» å‰ç«¯ åˆ° Node.js å†åˆ° åç«¯æ•°æ®åº“ï¼Œç¥æ‚¨æˆä¸ºä¼˜ç§€çš„é«˜çº§ Node.js å…¨æ ˆå·¥ç¨‹å¸ˆã€‚ä¸€ä¸ªæœ‰è¶£çš„ä¸”ä¹äºåˆ†äº«çš„äººã€‚åº§å³é“­ï¼šä»Šå¤©æœªå®Œæˆçš„ï¼Œæ˜å¤©æ›´ä¸ä¼šå®Œæˆã€‚</p><p>94ç¯‡åŸåˆ›å†…å®¹</p><p>å…¬ä¼—å·</p><p>å¤§å‚æŠ€æœ¯Â Â é«˜çº§å‰ç«¯Â Â Nodeè¿›é˜¶</p><p>ç‚¹å‡»ä¸Šæ–¹Â ç¨‹åºå‘˜æˆé•¿æŒ‡åŒ—ï¼Œå…³æ³¨å…¬ä¼—å·</p><p>å›å¤1ï¼ŒåŠ å…¥é«˜çº§Nodeäº¤æµç¾¤</p><blockquote><p>ä½œè€…ï¼šmolvqingtai</p><p>åŸæ–‡é“¾æ¥: <a href="https://juejin.cn/post/6971812117993226248" target="_blank" rel="noopener noreferrer">https://juejin.cn/post/6971812117993226248</a></p></blockquote><h2 id="å‰ç«¯å·¥ç¨‹åŒ–é…ç½®æŒ‡å—">å‰ç«¯å·¥ç¨‹åŒ–é…ç½®æŒ‡å—</h2><blockquote><p>æœ¬æ–‡è®²è§£å¦‚ä½•æ„å»ºä¸€ä¸ªå·¥ç¨‹åŒ–çš„å‰ç«¯åº“ï¼Œå¹¶ç»“åˆ Github Actionsï¼Œè‡ªåŠ¨å‘å¸ƒåˆ° GithubÂ å’Œ NPMÂ çš„æ•´ä¸ªè¯¦ç»†æµç¨‹ã€‚</p></blockquote><h2 id="ç¤ºä¾‹">ç¤ºä¾‹</h2><blockquote><p>æˆ‘ä»¬ç»å¸¸çœ‹åˆ°åƒ Vueã€ReactÂ è¿™äº›æµè¡Œçš„å¼€æºé¡¹ç›®æœ‰å¾ˆå¤šé…ç½®æ–‡ä»¶ï¼Œä»–ä»¬æ˜¯å¹²ä»€ä¹ˆç”¨çš„ï¼Ÿä»–ä»¬çš„ Commitã€Release è®°å½•éƒ½é‚£ä¹ˆè§„èŒƒï¼Œæ˜¯å¦åŸºäºæŸç§çº¦å®šï¼Ÿ</p></blockquote><p><strong>åºŸè¯å°‘è¯´ï¼Œå…ˆä¸Šå›¾ï¼</strong></p><p><img src="https://qn.huat.xyz/mac/20220716185137.png" alt="å›¾ç‰‡"> ä¸Šå›¾æ ‡çº¢å°±æ˜¯ç›¸å…³çš„å·¥ç¨‹åŒ–é…ç½®ï¼Œæœ‰ Linterã€Testsï¼ŒGithub Actions ç­‰ï¼Œè¦†ç›–å¼€å‘ã€æµ‹è¯•ã€å‘å¸ƒçš„æ•´ä¸ªæµç¨‹ã€‚</p><p><strong>ç›¸å…³é…ç½®æ¸…å•</strong></p><ul><li><p>Eslint</p></li><li><p>Prettier</p></li><li><p>Commitlint</p></li><li><p>Husky</p></li><li><p>Jest</p></li><li><p>GitHub Actions</p></li><li><p>Semantic Release</p></li></ul><p>ä¸‹é¢æˆ‘ä»¬ä»åˆ›å»ºä¸€ä¸ª TypeScript é¡¹ç›®å¼€å§‹ï¼Œä¸€æ­¥ä¸€æ­¥å®Œæˆæ‰€æœ‰çš„å·¥ç¨‹åŒ–é…ç½®ï¼Œå¹¶è¯´æ˜æ¯ä¸ªé…ç½®å«ä¹‰ä»¥åŠå®¹æ˜“è¸©çš„å‘ã€‚</p><h2 id="åˆå§‹åŒ–">åˆå§‹åŒ–</h2><p>ä¸ºäº†é¿å…å…¼å®¹æ€§é—®é¢˜ï¼Œå»ºè®®å…ˆå°† nodeÂ å‡çº§åˆ°æœ€æ–°çš„é•¿æœŸæ”¯æŒç‰ˆæœ¬ã€‚</p><p>é¦–å…ˆåœ¨ GithubÂ ä¸Šåˆ›å»ºä¸€ä¸ª repo,æ‹‰ä¸‹æ¥ä¹‹åé€šè¿‡<code>npm init -y</code>åˆå§‹åŒ–ã€‚ç„¶ååˆ›å»º<code>src</code>æ–‡ä»¶å¤¹ï¼Œå†™å…¥<code>index.ts</code>ã€‚</p><p><code>package.json</code> ç”Ÿæˆä¹‹åï¼Œæˆ‘éœ€è¦æ·»åŠ å¦‚ä¸‹é…ç½®é¡¹:</p><div class="language-auto"><pre><code>Â Â Â &quot;main&quot;:Â &quot;index.js&quot;,\n+Â Â &quot;type&quot;:Â &quot;module&quot;,\nÂ Â Â &quot;scripts&quot;:Â {\nÂ Â Â Â Â &quot;test&quot;:Â &quot;echoÂ \\&quot;Error:Â noÂ testÂ specified\\&quot;Â &amp;&amp;Â exitÂ 1&quot;\nÂ Â Â },\n+Â Â &quot;publishConfig&quot;:Â {\n+Â Â Â Â &quot;access&quot;:Â &quot;public&quot;\n+Â Â }\n</code></pre></div><p>æˆ‘ä»¬å°†é¡¹ç›®å®šä¹‰ä¸ºESMè§„èŒƒ,å‰ç«¯ç¤¾åŒºæ­£é€æ¸å‘ESMæ ‡å‡†è¿ç§»ï¼Œä»Node v12.0.0å¼€å§‹ï¼Œåªè¦è®¾ç½®äº† <code>&quot;type&quot;: &quot;module&quot;</code>, Node ä¼šå°†æ•´ä¸ªé¡¹ç›®è§†ä¸ºESMè§„èŒƒï¼Œæˆ‘ä»¬å°±å¯ä»¥ç›´æ¥å†™è£¸å†™<code>import/export</code>ã€‚</p><p><code>publishConfig.access</code>è¡¨ç¤ºå½“å‰é¡¹ç›®å‘å¸ƒåˆ°NPMçš„è®¿é—®çº§åˆ«ï¼Œå®ƒæœ‰ <code>restricted</code>å’Œ<code>public</code>ä¸¤ä¸ªé€‰é¡¹,<code>restricted</code>è¡¨ç¤ºæˆ‘ä»¬å‘å¸ƒåˆ°NPMä¸Šçš„æ˜¯ç§æœ‰åŒ…ï¼ˆæ”¶è´¹ï¼‰ï¼Œè®¿é—®çº§åˆ«é»˜è®¤ä¸º<code>restricted</code>,å› ä¸ºæˆ‘ä»¬æ˜¯å¼€æºé¡¹ç›®æ‰€ä»¥æ ‡è®°ä¸º<code>public</code>ã€‚</p><h2 id="é…ç½®">é…ç½®</h2><p>åˆ›å»ºé¡¹ç›®ä¹‹åï¼Œæˆ‘ä»¬å¼€å§‹å®‰è£…å·¥ç¨‹åŒ–ç›¸å…³çš„ä¾èµ–ï¼Œå› ä¸ºæˆ‘ä»¬æ˜¯ TypeScript é¡¹ç›®ï¼Œæ‰€ä»¥ä¹Ÿéœ€è¦å®‰è£… TypeScript çš„ä¾èµ–ã€‚</p><h3 id="typescript">Typescript</h3><p>å…ˆå®‰è£… TypeScriptï¼Œç„¶åä½¿ç”¨ <code>tsc</code> å‘½åç”Ÿæˆ <code>tsconfig.json</code>ã€‚</p><div class="language-auto"><pre><code>npmÂ iÂ typescriptÂ -D\nnpxÂ tscÂ --init\n</code></pre></div><p>ç„¶åæˆ‘ä»¬éœ€è¦æ·»åŠ ä¿®æ”¹ <code>tsconfig.json</code> çš„é…ç½®é¡¹ï¼Œå¦‚ä¸‹ï¼š</p><div class="language-auto"><pre><code>{\nÂ Â &quot;compilerOptions&quot;:Â {\nÂ Â Â Â /*Â BasicÂ OptionsÂ */\nÂ Â Â Â &quot;baseUrl&quot;:Â &quot;.&quot;,Â //Â æ¨¡å—è§£ææ ¹è·¯å¾„ï¼Œé»˜è®¤ä¸ºÂ tsconfig.jsonÂ ä½äºçš„ç›®å½•\nÂ Â Â Â &quot;rootDir&quot;:Â &quot;src&quot;,Â //Â ç¼–è¯‘è§£ææ ¹è·¯å¾„ï¼Œé»˜è®¤ä¸ºÂ tsconfig.jsonÂ ä½äºçš„ç›®å½•\nÂ Â Â Â &quot;target&quot;:Â &quot;ESNEXT&quot;,Â //Â æŒ‡å®šè¾“å‡ºÂ ECMAScriptÂ ç‰ˆæœ¬ï¼Œé»˜è®¤ä¸ºÂ es5\nÂ Â Â Â &quot;module&quot;:Â &quot;ESNext&quot;,Â //Â æŒ‡å®šè¾“å‡ºæ¨¡å—è§„èŒƒï¼Œé»˜è®¤ä¸ºÂ Commonjs\nÂ Â Â Â &quot;lib&quot;:Â [&quot;ESNext&quot;,Â &quot;DOM&quot;],Â //Â ç¼–è¯‘éœ€è¦åŒ…å«çš„Â APIï¼Œé»˜è®¤ä¸ºÂ targetÂ çš„é»˜è®¤å€¼\nÂ Â Â Â &quot;outDir&quot;:Â &quot;dist&quot;,Â //Â ç¼–è¯‘è¾“å‡ºæ–‡ä»¶å¤¹è·¯å¾„ï¼Œé»˜è®¤ä¸ºæºæ–‡ä»¶åŒçº§ç›®å½•\nÂ Â Â Â &quot;sourceMap&quot;:Â true,Â //Â å¯ç”¨Â sourceMapï¼Œé»˜è®¤ä¸ºÂ false\nÂ Â Â Â &quot;declaration&quot;:Â true,Â //Â ç”ŸæˆÂ .d.tsÂ ç±»å‹æ–‡ä»¶ï¼Œé»˜è®¤ä¸ºÂ false\nÂ Â Â Â &quot;declarationDir&quot;:Â &quot;dist/types&quot;,Â //Â .d.tsÂ ç±»å‹æ–‡ä»¶çš„è¾“å‡ºç›®å½•ï¼Œé»˜è®¤ä¸ºÂ outDirÂ ç›®å½•\nÂ Â Â Â /*Â StrictÂ Type-CheckingÂ OptionsÂ */\nÂ Â Â Â &quot;strict&quot;:Â true,Â //Â å¯ç”¨æ‰€æœ‰ä¸¥æ ¼çš„ç±»å‹æ£€æŸ¥é€‰é¡¹ï¼Œé»˜è®¤ä¸ºÂ true\nÂ Â Â Â &quot;esModuleInterop&quot;:Â true,Â //Â é€šè¿‡ä¸ºå¯¼å…¥å†…å®¹åˆ›å»ºå‘½åç©ºé—´ï¼Œå®ç°Â CommonJSÂ å’ŒÂ ESÂ æ¨¡å—ä¹‹é—´çš„äº’æ“ä½œæ€§ï¼Œé»˜è®¤ä¸ºÂ true\nÂ Â Â Â &quot;skipLibCheck&quot;:Â true,Â //Â è·³è¿‡å¯¼å…¥ç¬¬ä¸‰æ–¹Â libÂ å£°æ˜æ–‡ä»¶çš„ç±»å‹æ£€æŸ¥ï¼Œé»˜è®¤ä¸ºÂ true\nÂ Â Â Â &quot;forceConsistentCasingInFileNames&quot;:Â true,Â //Â å¼ºåˆ¶åœ¨æ–‡ä»¶åä¸­ä½¿ç”¨ä¸€è‡´çš„å¤§å°å†™ï¼Œé»˜è®¤ä¸ºÂ true\nÂ Â Â Â &quot;moduleResolution&quot;:Â &quot;Node&quot;,Â //Â æŒ‡å®šä½¿ç”¨å“ªç§æ¨¡å—è§£æç­–ç•¥ï¼Œé»˜è®¤ä¸ºÂ Classic\nÂ Â },\nÂ Â &quot;include&quot;:Â [&quot;src&quot;]Â //Â æŒ‡å®šéœ€è¦ç¼–è¯‘æ–‡ä»¶ï¼Œé»˜è®¤å½“å‰ç›®å½•ä¸‹é™¤äº†Â excludeÂ ä¹‹å¤–çš„æ‰€æœ‰.ts,Â .d.ts,.tsxÂ æ–‡ä»¶\n}Â \n</code></pre></div><p>æ›´å¤šè¯¦ç»†é…ç½®å‚è€ƒï¼š<a href="http://www.typescriptlang.org/tsconfig" target="_blank" rel="noopener noreferrer">www.typescriptlang.org/tsconfig</a></p><p>æ³¨æ„çš„ç‚¹ï¼Œå¦‚æœä½ çš„é¡¹ç›®æ¶‰åŠåˆ°<code>WebWorker API</code>ï¼Œéœ€è¦æ·»åŠ åˆ° <code>lib</code> å­—æ®µä¸­</p><div class="language-auto"><pre><code>&quot;lib&quot;:Â [&quot;ESNext&quot;,Â &quot;DOM&quot;,Â &quot;WebWorker&quot;],\n</code></pre></div><p>ç„¶åæˆ‘ä»¬å°†ç¼–è¯‘åçš„æ–‡ä»¶è·¯å¾„æ·»åŠ åˆ° <code>package.json</code>ï¼Œå¹¶åœ¨ <code>scripts</code> ä¸­æ·»åŠ ç¼–è¯‘å‘½ä»¤ã€‚</p><div class="language-auto"><pre><code>-Â Â &quot;main&quot;:Â &quot;index.js&quot;,\n+Â Â &quot;main&quot;:Â &quot;dist/index.js&quot;,\n+Â Â &quot;types&quot;:Â &quot;dist/types/index.d.ts&quot;\nÂ Â Â &quot;type&quot;:Â &quot;module&quot;,\n-Â Â Â &quot;scripts&quot;:Â {\n-Â Â Â Â Â &quot;test&quot;:Â &quot;echoÂ \\&quot;Error:Â noÂ testÂ specified\\&quot;Â &amp;&amp;Â exitÂ 1&quot;\n-Â Â Â },\n+Â Â Â &quot;scripts&quot;:Â {\n+Â Â Â Â Â &quot;dev&quot;:Â &quot;tscÂ --watch&quot;,\n+Â Â Â Â Â &quot;build&quot;:Â &quot;npmÂ runÂ cleanÂ &amp;&amp;Â tsc&quot;,\n+Â Â Â Â Â &quot;clean&quot;:Â &quot;rmÂ -rfÂ dist&quot;\n+Â Â },\nÂ Â Â &quot;publishConfig&quot;:Â {\nÂ Â Â Â Â &quot;access&quot;:Â &quot;public&quot;\nÂ Â Â }\n</code></pre></div><p><code>types</code> é…ç½®é¡¹æ˜¯æŒ‡å®šç¼–è¯‘ç”Ÿæˆçš„ç±»å‹æ–‡ä»¶ï¼Œå¦‚æœ <code>compilerOptions.declarationDir</code> æŒ‡å®šçš„æ˜¯<code>dist</code>ï¼Œä¹Ÿå°±æ˜¯æºç å’Œ <code>.d.ts</code> åŒçº§ï¼Œé‚£ä¹ˆ<code>types</code>å¯ä»¥çœç•¥ã€‚</p><p>éªŒè¯é…ç½®æ˜¯å¦ç”Ÿæ•ˆï¼Œåœ¨ <code>index.ts</code> å†™å…¥</p><div class="language-auto"><pre><code>constÂ calcÂ =Â (a:Â number,Â b:Â number)Â =&gt;Â {\nÂ Â returnÂ aÂ -Â b\n}\nconsole.log(calc(1024,Â 28))\n</code></pre></div><p>åœ¨æ§åˆ¶å°ä¸­æ‰§è¡Œ</p><div class="language-auto"><pre><code>npmÂ runÂ buildÂ &amp;&amp;Â nodeÂ dist/index.js\n</code></pre></div><p>ä¼šåœ¨ <code>dist</code> ç›®å½•ä¸­ç”Ÿæˆ <code>types/index.d.ts</code>ã€<code>index.js</code>ã€<code>index.js.map</code>ï¼Œå¹¶æ‰“å° <code>996</code>ã€‚</p><h3 id="eslint-prettier">Eslint &amp; Prettier</h3><p>ä»£ç è§„èŒƒç¦»ä¸å¼€å„ç§ <code>Linter</code>, ä¹‹æ‰€ä»¥æŠŠè¿™ä¸¤ä¸ªæ”¾åœ¨ä¸€èµ·è®²ï¼Œå€Ÿç”¨ <code>Prettier</code> å®˜ç½‘çš„ä¸€å¥è¯ï¼šâ€œä½¿ç”¨ Prettier è§£å†³ä»£ç æ ¼å¼é—®é¢˜ï¼Œä½¿ç”¨ linters è§£å†³ä»£ç è´¨é‡é—®é¢˜â€ã€‚è™½ç„¶<code>eslint</code>ä¹Ÿæœ‰æ ¼å¼åŒ–åŠŸèƒ½ï¼Œä½†æ˜¯<code>prettier</code>çš„æ ¼å¼åŒ–åŠŸèƒ½æ›´å¼ºå¤§ã€‚</p><p>å¤§éƒ¨åˆ†åŒå­¦ç¼–è¾‘å™¨éƒ½è£…äº†prettier-vscodeå’Œeslint-vscodeè¿™ä¸¤ä¸ªæ’ä»¶ï¼Œå¦‚æœä½ é¡¹ç›®åªæœ‰å…¶ä¸­ä¸€ä¸ªçš„é…ç½®ï¼Œå› ä¸ºè¿™ä¸¤è€…éƒ¨åˆ†æ ¼å¼åŒ–çš„åŠŸèƒ½æœ‰å·®å¼‚ï¼Œé‚£ä¹ˆå°±ä¼šé€ æˆä¸€ä¸ªçš„é—®é¢˜ï¼Œä»£ç åˆ†åˆ«è¢«ä¸¤ä¸ªæ’ä»¶åˆ†åˆ«æ ¼å¼åŒ–ä¸€æ¬¡ï¼Œç½‘ä¸Šè§£å†³<code>prettier</code>+<code>eslint</code>å†²çªçš„æ–¹æ¡ˆäº”èŠ±å…«é—¨ï¼Œç”šè‡³è¿˜æœ‰æŠŠæ•´ä¸ª<code>rules</code>åˆ—è¡¨è´´å‡ºæ¥çš„ã€‚</p><p>é‚£è¿™é‡Œæˆ‘ä»¬æŒ‰ç…§å®˜æ–¹æ¨èï¼Œç”¨æœ€å°‘çš„é…ç½®å»è§£å†³<code>prettier</code>å’Œ<code>eslint</code>çš„é›†æˆé—®é¢˜ã€‚</p><h4 id="eslint">Eslint</h4><p>é¦–å…ˆå®‰è£… <code>eslint</code>ï¼Œç„¶ååˆ©ç”¨ <code>eslint</code> çš„å‘½ä»¤è¡Œå·¥å…·ç”ŸæˆåŸºæœ¬é…ç½®ã€‚</p><div class="language-auto"><pre><code>npmÂ iÂ eslintÂ -D\nnpxÂ eslintÂ --init\n</code></pre></div><p>æ‰§è¡Œä¸Šé¢å‘½ä»¤åä¼šæç¤ºä¸€äº›é€‰é¡¹ï¼Œæˆ‘ä»¬ä¾æ¬¡é€‰æ‹©ç¬¦åˆæˆ‘ä»¬é¡¹ç›®çš„é…ç½®ã€‚</p><p>æ³¨æ„ï¼Œè¿™é‡Œ <code>eslint</code> æ¨èäº†ä¸‰ç§ç¤¾åŒºä¸»æµçš„è§„èŒƒï¼ŒAirbnbã€Standardã€Googleï¼Œå› ä¸ªäººçˆ±å¥½æˆ‘é€‰æ‹©äº†ä¸å†™åˆ†å·çš„ Standardè§„èŒƒã€‚</p><p>ç”Ÿæˆçš„<code>.eslintrc.cjs</code>æ–‡ä»¶åº”è¯¥é•¿è¿™æ ·</p><div class="language-auto"><pre><code>module.exportsÂ =Â {\nÂ Â env:Â {\nÂ Â Â Â browser:Â true,\nÂ Â Â Â es2021:Â true,\nÂ Â Â Â node:Â true\nÂ Â },\nÂ Â extends:Â [\nÂ Â Â Â &#39;standard&#39;\nÂ Â ],\nÂ Â parser:Â &#39;@typescript-eslint/parser&#39;,\nÂ Â parserOptions:Â {\nÂ Â Â Â ecmaVersion:Â 12,\nÂ Â Â Â sourceType:Â &#39;module&#39;\nÂ Â },\nÂ Â plugins:Â [\nÂ Â Â Â &#39;@typescript-eslint&#39;\nÂ Â ],\nÂ Â rules:Â {\nÂ Â }\n}\n</code></pre></div><p>æœ‰äº›åŒå­¦å¯èƒ½å°±è¦é—®äº†ï¼Œè¿™é‡Œä¸ºä»€ä¹ˆç”Ÿæˆçš„é…ç½®æ–‡ä»¶åç§°æ˜¯<code>.eslintrc.cjs</code>è€Œä¸æ˜¯<code>.eslintrc.js</code>ï¼Ÿ</p><p>å› ä¸ºæˆ‘ä»¬å°†é¡¹ç›®å®šä¹‰ä¸º<code>ESM</code>ï¼Œ<code>eslit --init</code>ä¼šè‡ªåŠ¨è¯†åˆ«<code>type</code>ï¼Œå¹¶ç”Ÿæˆå…¼å®¹çš„é…ç½®æ–‡ä»¶åç§°ï¼Œå¦‚æœæˆ‘ä»¬æ”¹å›<code>.js</code>ç»“å°¾ï¼Œå†è¿è¡Œ<code>eslint</code>å°†ä¼šæŠ¥é”™ã€‚å‡ºç°è¿™ä¸ªé—®é¢˜æ˜¯<code>eslint</code>å†…éƒ¨ä½¿ç”¨äº†<code>require()</code>è¯­æ³•è¯»å–é…ç½®ã€‚</p><p>åŒæ ·ï¼Œè¿™ä¸ªé—®é¢˜ä¹Ÿé€‚ç”¨äºå…¶ä»–åŠŸèƒ½çš„é…ç½®ï¼Œæ¯”å¦‚åé¢ä¼šè®²åˆ°çš„<code>Prettier</code>ã€<code>Commitlint</code>ç­‰ï¼Œé…ç½®æ–‡ä»¶éƒ½ä¸èƒ½ä»¥<code>xx.js</code>ç»“å°¾ï¼Œè€Œè¦æ”¹ä¸ºå½“å‰åº“æ”¯æŒçš„å…¶ä»–é…ç½®æ–‡ä»¶æ ¼å¼ï¼Œå¦‚ï¼š<code>.xxrc</code>ã€<code>.xxrc.json</code>ã€<code>.xxrc.yml</code>ã€‚</p><p>éªŒè¯é…ç½®æ˜¯å¦ç”Ÿæ•ˆï¼Œä¿®æ”¹<code>index.ts</code></p><div class="language-auto"><pre><code>Â Â constÂ calcÂ =Â (a:Â number,Â b:Â number)Â =&gt;Â {\nÂ Â Â Â returnÂ aÂ -Â b\nÂ Â }\n-Â console.log(calc(1024,Â 28))\n+Â //Â console.log(calc(1024,Â 28))\n</code></pre></div><p>åœ¨<code>package.json</code>ä¸­æ·»åŠ <code>lint</code>å‘½ä»¤</p><div class="language-auto"><pre><code>Â Â &quot;scripts&quot;:Â {\nÂ Â Â Â &quot;dev&quot;:Â &quot;tscÂ --watch&quot;,\nÂ Â Â Â &quot;build&quot;:Â &quot;npmÂ runÂ cleanÂ &amp;&amp;Â tsc&quot;,\n+Â Â Â &quot;lint&quot;:Â &quot;eslintÂ srcÂ --extÂ .js,.tsÂ --cacheÂ --fix&quot;,\nÂ Â Â Â &quot;clean&quot;:Â &quot;rmÂ -rfÂ dist&quot;\nÂ Â },\n</code></pre></div><p>ç„¶ååœ¨æ§åˆ¶å°æ‰§è¡Œ <code>lint</code>,<code>eslint</code>å°†ä¼šæç¤º 1 æ¡é”™è¯¯ä¿¡æ¯ï¼Œè¯´æ˜æ ¡éªŒç”Ÿæ•ˆã€‚</p><div class="language-auto"><pre><code>npmÂ runÂ lint\n#Â 1:7Â Â errorÂ Â &#39;calc&#39;Â isÂ assignedÂ aÂ valueÂ butÂ neverÂ usedÂ Â no-unused-vars\n</code></pre></div><p>å› ä¸ºæ˜¯ Typescript é¡¹ç›®æ‰€ä»¥æˆ‘ä»¬è¿˜è¦æ·»åŠ Standardè§„èŒƒæä¾›çš„ TypeScrip æ‰©å±•é…ç½®(å…¶ä»–è§„èŒƒåŒç†)</p><p>å®‰è£…eslint-config-standard-with-typescript</p><div class="language-auto"><pre><code>npm i eslint-config-standard-with-typescript -D\n</code></pre></div><p>æ·»åŠ ä¿®æ”¹ <code>.eslintrc.cjs</code></p><div class="language-auto"><pre><code>Â Â Â Â module.exportsÂ =Â {\nÂ Â Â Â Â Â env:Â {\nÂ Â Â Â Â Â Â Â browser:Â true,\nÂ Â Â Â Â Â Â Â es2021:Â true,\nÂ Â Â Â Â Â Â Â node:Â true\nÂ Â Â Â Â Â },\n-Â Â Â Â Â extends:Â [&#39;standard&#39;]\n+Â Â Â Â Â extends:Â [&#39;standard&#39;,Â &#39;eslint-config-standard-with-typescript&#39;],\nÂ Â Â Â Â Â parser:Â &#39;@typescript-eslint/parser&#39;,\nÂ Â Â Â Â Â parserOptions:Â {\nÂ Â Â Â Â Â Â Â ecmaVersion:Â 12,\nÂ Â Â Â Â Â Â Â sourceType:Â &#39;module&#39;,\n+Â Â Â Â Â Â Â project:Â &#39;./tsconfig.json&#39;\nÂ Â Â Â Â Â },\nÂ Â Â Â Â Â plugins:Â [&#39;@typescript-eslint&#39;],\nÂ Â Â Â Â Â rules:Â {}\nÂ Â Â Â }\n\n</code></pre></div><p>éªŒè¯é…ç½®æ˜¯å¦ç”Ÿæ•ˆ</p><p>åœ¨æ§åˆ¶å°æ‰§è¡Œ<code>lint</code>,<code>eslint</code>å°†ä¼šæç¤º 2 æ¡é”™è¯¯ä¿¡æ¯ï¼Œè¯´æ˜æ ¡éªŒç”Ÿæ•ˆã€‚</p><div class="language-auto"><pre><code>npmÂ runÂ lint\n#Â 1:7Â Â errorÂ Â &#39;calc&#39;Â isÂ assignedÂ aÂ valueÂ butÂ neverÂ usedÂ Â no-unused-vars\n#Â 1:14Â errorÂ Â MissingÂ returnÂ typeÂ onÂ functionÂ \n</code></pre></div><h4 id="prettier">Prettier</h4><p>ç°åœ¨æˆ‘ä»¬æŒ‰ç…§å®˜ç½‘çš„æ¨èæ–¹å¼ï¼ŒæŠŠ <code>prettier</code> é›†æˆåˆ° <code>eslint</code> çš„æ ¡éªŒä¸­ã€‚</p><p>å®‰è£… <code>prettier</code> å¹¶åˆå§‹åŒ–é…ç½®æ–‡ä»¶</p><div class="language-auto"><pre><code>npmÂ iÂ prettierÂ -D\nechoÂ {}&gt;Â .prettierrc.json\n</code></pre></div><p>ç„¶ååœ¨<code>.prettierrc.json</code>æ·»åŠ é…ç½®ï¼Œè¿™é‡Œåªéœ€è¦æ·»åŠ å’Œä½ æ‰€é€‰è§„èŒƒå†²çªçš„éƒ¨åˆ†ã€‚</p><div class="language-auto"><pre><code>{\nÂ Â &quot;semi&quot;:Â false,Â //Â æ˜¯å¦ä½¿ç”¨åˆ†å·\nÂ Â &quot;singleQuote&quot;:Â true,Â //Â ä½¿ç”¨å•å¼•å·ä»£æ›¿åŒå¼•å·\nÂ Â &quot;trailingComma&quot;:Â &quot;none&quot;Â //Â å¤šè¡Œæ—¶å°½å¯èƒ½ä½¿ç”¨é€—å·ç»“å°¾\n}\n</code></pre></div><p>æ›´å¤šé…ç½®è¯¦è§ï¼š<a href="http://prettier.io/docs/en/opt%E2%80%A6" target="_blank" rel="noopener noreferrer">prettier.io/docs/en/optâ€¦</a></p><p>å®‰è£…è§£å†³å†²çªéœ€è¦ç”¨åˆ°çš„ä¸¤ä¸ªä¾èµ–</p><ul><li><p>eslint-config-prettierÂ å…³é—­å¯èƒ½ä¸ <code>prettier</code> å†²çªçš„è§„åˆ™</p></li><li><p>eslint-plugin-prettierÂ ä½¿ç”¨ <code>prettier</code> ä»£æ›¿ <code>eslint</code> æ ¼å¼åŒ–</p></li></ul><div class="language-auto"><pre><code>npmÂ iÂ eslint-config-prettierÂ eslint-plugin-prettierÂ -D\n</code></pre></div><p>å†æ·»åŠ ä¿®æ”¹ <code>.eslintrc.cjs</code>ï¼Œå¦‚ä¸‹ï¼š</p><div class="language-auto"><pre><code>Â Â module.exportsÂ =Â {\nÂ Â env:Â {\nÂ Â Â Â browser:Â true,\nÂ Â Â Â es2021:Â true,\nÂ Â Â Â node:Â true,\nÂ Â },\n-Â extends:Â [&#39;standard&#39;,Â &#39;eslint-config-standard-with-typescript&#39;],\n+Â extends:Â [&#39;standard&#39;,Â &#39;eslint-config-standard-with-typescript&#39;,Â &#39;prettier&#39;],\nÂ Â parser:Â &#39;@typescript-eslint/parser&#39;,\nÂ Â parserOptions:Â {\nÂ Â Â Â ecmaVersion:Â 12,\nÂ Â Â Â sourceType:Â &#39;module&#39;,\nÂ Â Â Â project:Â &#39;./tsconfig.json&#39;,\nÂ Â },\n-Â plugins:Â [&#39;@typescript-eslint&#39;],\n+Â plugins:Â [&#39;@typescript-eslint&#39;,Â &#39;prettier&#39;],\n-Â rules:Â {},\n+Â rules:Â {\n+Â Â Â &#39;prettier/prettier&#39;:Â &#39;error&#39;\n+Â },\n}\n</code></pre></div><p>ç„¶åéªŒè¯é…ç½®æ˜¯å¦ç”Ÿæ•ˆï¼Œä¿®æ”¹<code>index.ts</code></p><div class="language-auto"><pre><code>-Â Â constÂ calcÂ =Â (a:Â number,Â b:Â number)Â =&gt;Â {\n+Â Â constÂ calcÂ =Â (a:Â number,Â b:Â number):Â numberÂ =&gt;Â {\nÂ Â Â Â returnÂ aÂ -Â b\nÂ Â }\n-Â //Â console.log(calc(1024,Â 28))\n+Â console.log(calc(1024,Â 28))\n</code></pre></div><p>ç„¶ååœ¨æ§åˆ¶å°æ‰§è¡Œ<code>lint</code>,è¿™é‡Œ<code>prettier</code>å’Œ<code>eslint</code>çš„è¡Œä¸ºå·²ä¿æŒä¸€è‡´ï¼Œå¦‚æœæ²¡æœ‰æŠ¥é”™ï¼Œé‚£å°±æˆåŠŸäº†ã€‚</p><div class="language-auto"><pre><code>npmÂ runÂ lint\n</code></pre></div><p>æˆ‘ä»¬ç°åœ¨å·²ç»å®Œæˆäº†<code>eslint</code>å’Œ<code>prettier</code>çš„é›†æˆé…ç½®ã€‚å’Œç¼–è¾‘å™¨æ— å…³ï¼Œä¹Ÿå°±æ˜¯è¯´æ— è®ºä½ ä½¿ç”¨ä»€ä¹ˆç¼–è¾‘å™¨ï¼Œæœ‰æ²¡æœ‰å®‰è£…ç›¸å…³æ’ä»¶ï¼Œéƒ½ä¸ä¼šå½±å“ä»£ç æ ¡éªŒçš„æ•ˆæœã€‚</p><h3 id="husky">Husky</h3><p>å› ä¸ºä¸€ä¸ªé¡¹ç›®é€šå¸¸æ˜¯å›¢é˜Ÿåˆä½œï¼Œæˆ‘ä»¬ä¸èƒ½ä¿è¯æ¯ä¸ªäººåœ¨æäº¤ä»£ç ä¹‹å‰æ‰§è¡Œä¸€é<code>lint</code>æ ¡éªŒï¼Œæ‰€ä»¥éœ€è¦<code>git hooks</code> æ¥è‡ªåŠ¨åŒ–æ ¡éªŒçš„è¿‡ç¨‹ï¼Œå¦åˆ™ç¦æ­¢æäº¤ã€‚</p><p>å®‰è£…<code>Husky</code>å¹¶ç”Ÿæˆ<code>.husky</code>æ–‡ä»¶å¤¹</p><div class="language-auto"><pre><code>npmÂ iÂ huskyÂ -D\nnpxÂ huskyÂ install\n</code></pre></div><p>ç„¶åæˆ‘ä»¬éœ€è¦åœ¨æ¯æ¬¡æ‰§è¡Œ<code>npm install</code>æ—¶è‡ªåŠ¨å¯ç”¨<code>husky</code></p><p>å¦‚æœä½ çš„<code>npm</code>ç‰ˆæœ¬å¤§äºç­‰äº<code>7.1.0</code></p><div class="language-auto"><pre><code>npmÂ set-scriptÂ prepareÂ &quot;huskyÂ install&quot;\n</code></pre></div><p>å¦åˆ™æ‰‹åŠ¨åœ¨<code>package.json</code>ä¸­æ·»åŠ </p><div class="language-auto"><pre><code>Â &quot;scripts&quot;:Â {\nÂ Â Â Â &quot;dev&quot;:Â &quot;tscÂ --watch&quot;,\nÂ Â Â Â &quot;build&quot;:Â &quot;npmÂ runÂ cleanÂ &amp;&amp;Â tsc&quot;,\nÂ Â Â Â &quot;lint&quot;:Â &quot;eslintÂ srcÂ --extÂ .js,.tsÂ --cacheÂ --fix&quot;,\nÂ Â Â Â &quot;clean&quot;:Â &quot;rmÂ -rfÂ dist&quot;,\n+Â Â Â &quot;prepare&quot;:Â &quot;huskyÂ install&quot;\nÂ Â },\n</code></pre></div><p>ç„¶åæ·»åŠ ä¸€ä¸ª<code>lint</code>é’©å­</p><div class="language-auto"><pre><code>npx husky add .husky/pre-commit &quot;npm run lint&quot;\n</code></pre></div><p>ç›¸å½“äºæ‰‹åŠ¨åœ¨<code>.husky/pre-commit</code>æ–‡ä»¶å†™å…¥ä»¥ä¸‹å†…å®¹ï¼š</p><div class="language-auto"><pre><code>#!/bin/sh\n.Â &quot;$(dirnameÂ &quot;$0&quot;)/_/husky.sh&quot;\nnpmÂ runÂ lint\n</code></pre></div><p>æµ‹è¯•é’©å­æ˜¯å¦ç”Ÿæ•ˆï¼Œä¿®æ”¹<code>index.ts</code></p><div class="language-auto"><pre><code>Â Â constÂ calcÂ =Â (a:Â number,Â b:Â number):Â numberÂ =&gt;Â {\nÂ Â Â Â returnÂ aÂ -Â b\nÂ Â }\n-Â console.log(calc(1024,Â 28))\n+Â //Â console.log(calc(1024,Â 28))\n</code></pre></div><p>ç„¶åæäº¤ä¸€æ¡<code>commit</code>,å¦‚æœé…ç½®æ­£ç¡®å°†ä¼šè‡ªåŠ¨æ‰§è¡Œ<code>lint</code>å¹¶æç¤º 1 æ¡é”™è¯¯ä¿¡æ¯ï¼Œ<code>commit</code>æäº¤å°†ä¼šå¤±è´¥ã€‚</p><div class="language-auto"><pre><code>gitÂ addÂ .\ngitÂ commitÂ -mÂ &#39;testÂ husky&#39;\n#Â 1:7Â Â errorÂ Â &#39;calc&#39;Â isÂ assignedÂ aÂ valueÂ butÂ neverÂ used\n</code></pre></div><h3 id="commitlint">Commitlint</h3><p>ä¸ºä»€ä¹ˆéœ€è¦ <code>Commitlint</code>ï¼Œé™¤äº†åœ¨åç»­çš„ç”Ÿæˆ<code>changelog</code>æ–‡ä»¶å’Œè¯­ä¹‰å‘ç‰ˆä¸­éœ€è¦æå–<code>commit</code>ä¸­çš„ä¿¡æ¯ï¼Œä¹Ÿåˆ©äºå…¶ä»–åŒå­¦åˆ†æä½ æäº¤çš„ä»£ç ï¼Œæ‰€ä»¥æˆ‘ä»¬è¦çº¦å®š<code>commit</code>çš„è§„èŒƒã€‚</p><p>å®‰è£… <code>Commitlint</code></p><ul><li><p>@commitlint/cliÂ Commitlint å‘½ä»¤è¡Œå·¥å…·</p></li><li><p>@commitlint/config-conventionalÂ åŸºäº Angular çš„çº¦å®šè§„èŒƒ</p></li></ul><div class="language-auto"><pre><code>npmÂ iÂ @commitlint/config-conventionalÂ @commitlint/cliÂ -D\n</code></pre></div><p>æœ€åå°†<code>Commitlint</code>æ·»åŠ åˆ°é’©å­</p><div class="language-auto"><pre><code>npxÂ huskyÂ addÂ .husky/commit-msgÂ &#39;npxÂ --no-installÂ commitlintÂ --editÂ &quot;$1&quot;&#39;\n</code></pre></div><p>åˆ›å»º<code>.commitlintrc</code>ï¼Œå¹¶å†™å…¥é…ç½®</p><div class="language-auto"><pre><code>{\nÂ Â &quot;extends&quot;:Â [\nÂ Â Â Â &quot;@commitlint/config-conventional&quot;\nÂ Â ]\n}\n</code></pre></div><p>æ³¨æ„ï¼Œè¿™é‡Œé…ç½®æ–‡ä»¶åä½¿ç”¨çš„æ˜¯<code>.commitlintrc</code>è€Œä¸æ˜¯é»˜è®¤çš„<code>.commitlintrc.js</code>ï¼Œè¯¦è§ Eslint ç« èŠ‚</p><p>æµ‹è¯•é’©å­æ˜¯å¦ç”Ÿæ•ˆï¼Œä¿®æ”¹<code>index.ts</code>ï¼Œè®©ä»£ç æ­£ç¡®</p><div class="language-auto"><pre><code>Â Â constÂ calcÂ =Â (a:Â number,Â b:Â number):Â voidÂ =&gt;Â {\nÂ Â Â Â console.log(aÂ -Â b)\nÂ Â }\n-Â //Â calc(1024,Â 28)\n+Â calc(1024,Â 28)\n</code></pre></div><p>æäº¤ä¸€æ¡ä¸ç¬¦åˆè§„èŒƒçš„<code>commit</code>ï¼Œæäº¤å°†ä¼šå¤±è´¥</p><div class="language-auto"><pre><code>gitÂ addÂ .\ngitÂ commitÂ -mÂ &#39;addÂ eslintÂ andÂ commitlint&#39;\n</code></pre></div><p>ä¿®æ”¹ä¸ºæ­£ç¡®çš„<code>commit</code>ï¼Œæäº¤æˆåŠŸï¼</p><div class="language-auto"><pre><code>gitÂ commitÂ -mÂ &#39;ci:Â addÂ eslintÂ andÂ commitlint&#39;\n</code></pre></div><p><em>Angular è§„èŒƒè¯´æ˜ï¼š</em></p><ul><li><p><em>feat</em>ï¼šæ–°åŠŸèƒ½</p></li><li><p><em>fix</em>ï¼šä¿®è¡¥ BUG</p></li><li><p><em>docs</em>ï¼šä¿®æ”¹æ–‡æ¡£ï¼Œæ¯”å¦‚ README, CHANGELOG, CONTRIBUTE ç­‰ç­‰</p></li><li><p><em>style</em>ï¼šä¸æ”¹å˜ä»£ç é€»è¾‘ (ä»…ä»…ä¿®æ”¹äº†ç©ºæ ¼ã€æ ¼å¼ç¼©è¿›ã€é€—å·ç­‰ç­‰)</p></li><li><p><em>refactor</em>ï¼šé‡æ„ï¼ˆæ—¢ä¸ä¿®å¤é”™è¯¯ä¹Ÿä¸æ·»åŠ åŠŸèƒ½ï¼‰</p></li><li><p><em>perf</em>ï¼šä¼˜åŒ–ç›¸å…³ï¼Œæ¯”å¦‚æå‡æ€§èƒ½ã€ä½“éªŒ</p></li><li><p><em>test</em>ï¼šå¢åŠ æµ‹è¯•ï¼ŒåŒ…æ‹¬å•å…ƒæµ‹è¯•ã€é›†æˆæµ‹è¯•ç­‰</p></li><li><p><em>build</em>ï¼šæ„å»ºç³»ç»Ÿæˆ–å¤–éƒ¨ä¾èµ–é¡¹çš„æ›´æ”¹</p></li><li><p><em>ci</em>ï¼šè‡ªåŠ¨åŒ–æµç¨‹é…ç½®æˆ–è„šæœ¬ä¿®æ”¹</p></li><li><p><em>chore</em>ï¼šé src å’Œ test çš„ä¿®æ”¹ï¼Œå‘å¸ƒç‰ˆæœ¬ç­‰</p></li><li><p><em>revert</em>ï¼šæ¢å¤å…ˆå‰çš„æäº¤</p></li></ul><h3 id="jest">Jest</h3><p><em>ç¾å¥½ç”Ÿæ´»ä»æµ‹è¯•è¦†ç›–ç‡ 100% å¼€å§‹ã€‚</em></p><p>å®‰è£…<code>jest</code>ï¼Œå’Œç±»å‹å£°æ˜<code>@types/jest</code>ï¼Œå®ƒæ‰§è¡Œéœ€è¦<code>ts-node</code>å’Œ<code>ts-jest</code></p><p>è¿™é‡Œæš‚æ—¶å›ºå®šäº†<code>ts-node</code>çš„ç‰ˆæœ¬ä¸º <code>v9.1.1</code>ï¼Œæ–°ç‰ˆçš„<code>ts-node@v10.0.0</code>ä¼šå¯¼è‡´<code>jest</code>æŠ¥é”™ï¼Œç­‰å¾…å®˜æ–¹ä¿®å¤ï¼Œè¯¦è§ï¼šissues</p><div class="language-auto"><pre><code>npmÂ iÂ jestÂ @types/jestÂ ts-node@9.1.1Â ts-jestÂ -D\n</code></pre></div><p>åˆå§‹åŒ–é…ç½®æ–‡ä»¶</p><div class="language-auto"><pre><code>npx jest --init\n</code></pre></div><p>ç„¶åä¿®æ”¹<code>jest.config.ts</code>æ–‡ä»¶</p><div class="language-auto"><pre><code>Â Â Â //Â AÂ presetÂ thatÂ isÂ usedÂ asÂ aÂ baseÂ forÂ Jest&#39;sÂ configuration\n-Â Â //Â preset:Â undefined,\n+Â Â preset:Â &#39;ts-jest&#39;\n</code></pre></div><p>å°†æµ‹è¯•å‘½ä»¤æ·»åŠ åˆ°<code>package.json</code>ä¸­ã€‚</p><div class="language-auto"><pre><code>Â Â &quot;scripts&quot;:Â {\nÂ Â Â Â &quot;dev&quot;:Â &quot;tscÂ --watch&quot;,\nÂ Â Â Â &quot;build&quot;:Â &quot;npmÂ runÂ cleanÂ &amp;&amp;Â tsc&quot;,\nÂ Â Â Â &quot;lint&quot;:Â &quot;eslintÂ srcÂ --extÂ .js,.tsÂ --cacheÂ --fix&quot;,\nÂ Â Â Â &quot;clean&quot;:Â &quot;rmÂ -rfÂ dist&quot;,\nÂ Â Â Â &quot;prepare&quot;:Â &quot;huskyÂ install&quot;,\n+Â Â Â &quot;test&quot;:Â &quot;jest&quot;\nÂ Â },\n</code></pre></div><p>åˆ›å»ºæµ‹è¯•æ–‡ä»¶å¤¹<code>__tests__</code>å’Œæµ‹è¯•æ–‡ä»¶<code>__tests__/calc.spec.ts</code></p><p>ä¿®æ”¹<code>index.ts</code></p><div class="language-auto"><pre><code>Â Â constÂ calcÂ =Â (a:Â number,Â b:Â number):Â numberÂ =&gt;Â {\nÂ Â Â Â returnÂ aÂ -Â b\nÂ Â }\n-Â //Â console.log(calc(1024,Â 28))\n+Â exportÂ defaultÂ calc\n</code></pre></div><p>ç„¶ååœ¨<code>calc.spec.ts</code>ä¸­å†™å…¥æµ‹è¯•ä»£ç </p><div class="language-auto"><pre><code>importÂ calcÂ fromÂ &#39;../src&#39;\n\ntest(&#39;TheÂ calculationÂ resultÂ shouldÂ beÂ 996.&#39;,Â ()Â =&gt;Â {\nÂ Â expect(calc(1024,Â 28)).toBe(996)\n})\n</code></pre></div><p>éªŒè¯é…ç½®æ˜¯å¦ç”Ÿæ•ˆ</p><p>åœ¨æ§åˆ¶å°æ‰§è¡Œ<code>test</code>ï¼Œå°†ä¼šçœ‹åˆ°æµ‹è¯•è¦†ç›–ç‡ 100% çš„ç»“æœã€‚</p><div class="language-auto"><pre><code>npmÂ runÂ test\n</code></pre></div><p>æœ€åæˆ‘ä»¬ç»™<code>__tests__</code>ç›®å½•ä¹ŸåŠ ä¸Š<code>lint</code>æ ¡éªŒ</p><p>ä¿®æ”¹<code>package.json</code></p><div class="language-auto"><pre><code>Â Â &quot;scripts&quot;:Â {\nÂ Â Â Â &quot;dev&quot;:Â &quot;tscÂ --watch&quot;,\nÂ Â Â Â &quot;build&quot;:Â &quot;npmÂ runÂ cleanÂ &amp;&amp;Â tsc&quot;,\n-Â Â Â &quot;lint&quot;:Â &quot;eslintÂ srcÂ --extÂ .js,.tsÂ --cacheÂ --fix&quot;,\n+Â Â Â &quot;lint&quot;:Â &quot;eslintÂ srcÂ __tests__Â --extÂ .js,.tsÂ --cacheÂ --fix&quot;,\nÂ Â Â Â &quot;clean&quot;:Â &quot;rmÂ -rfÂ dist&quot;,\nÂ Â Â Â &quot;prepare&quot;:Â &quot;huskyÂ install&quot;,\nÂ Â Â Â &quot;test&quot;:Â &quot;jest&quot;\nÂ Â },\n</code></pre></div><p>è¿™é‡Œå¦‚æœæˆ‘ä»¬ç›´æ¥æ‰§è¡Œ<code>npm run lint</code>å°†ä¼šæŠ¥é”™ï¼Œæç¤º<code>__tests__</code>æ–‡ä»¶å¤¹æ²¡æœ‰åŒ…å«åœ¨<code>tsconfig.json</code>çš„<code>include</code>ä¸­ï¼Œå½“æˆ‘ä»¬æ·»åŠ åˆ°<code>include</code>ä¹‹åï¼Œè¾“å‡ºçš„<code>dist</code>ä¸­å°±ä¼šåŒ…å«æµ‹è¯•ç›¸å…³çš„æ–‡ä»¶ï¼Œè¿™å¹¶ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„æ•ˆæœã€‚</p><p>æˆ‘ä»¬ä½¿ç”¨<code>typescript-eslint</code>å®˜æ–¹ç»™å‡ºçš„è§£å†³æ–¹æ¡ˆï¼Œå¦‚ä¸‹æ“ä½œï¼š</p><p>æ–°å»ºä¸€ä¸ª<code>tsconfig.eslint.json</code>æ–‡ä»¶ï¼Œå†™å…¥ä»¥ä¸‹å†…å®¹ï¼š</p><div class="language-auto"><pre><code>{\nÂ Â &quot;extends&quot;:Â &quot;./tsconfig.json&quot;,\nÂ Â &quot;include&quot;:Â [&quot;**/*.ts&quot;,Â &quot;**/*.js&quot;]\n}\n</code></pre></div><p>åœ¨<code>.eslintrc.cjs</code>ä¸­ä¿®æ”¹</p><div class="language-auto"><pre><code>Â Â parserOptions:Â {\nÂ Â Â Â ecmaVersion:Â 12,\nÂ Â Â Â sourceType:Â &#39;module&#39;,\n-Â Â Â project:Â &#39;./tsconfig.json&#39;\n+Â Â Â project:Â &#39;./tsconfig.eslint.json&#39;\nÂ Â },\n</code></pre></div><p>ç„¶åéªŒè¯é…ç½®æ˜¯å¦ç”Ÿæ•ˆï¼Œç›´æ¥æäº¤æˆ‘ä»¬æ·»åŠ çš„æµ‹è¯•æ–‡ä»¶,èƒ½æ­£ç¡®æäº¤è¯´æ˜é…ç½®æˆåŠŸã€‚</p><div class="language-auto"><pre><code>gitÂ addÂ .\ngitÂ commitÂ -mÂ &#39;test:Â addÂ unitÂ test&#39;\n</code></pre></div><h3 id="github-actions">Github Actions</h3><p>æˆ‘ä»¬é€šè¿‡<code>Github Actions</code>å®ç°ä»£ç åˆå¹¶æˆ–æ¨é€åˆ°ä¸»åˆ†æ”¯ï¼Œ<code>dependabot</code>æœºå™¨äººå‡çº§ä¾èµ–ç­‰åŠ¨ä½œï¼Œä¼šè‡ªåŠ¨è§¦å‘æµ‹è¯•å’Œå‘å¸ƒç‰ˆæœ¬ç­‰ä¸€ç³»åˆ—æµç¨‹ã€‚</p><p>åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»º<code>.github/workflows</code>æ–‡ä»¶å¤¹ï¼Œç„¶ååœ¨é‡Œé¢æ–°å»º<code>ci.yml</code>æ–‡ä»¶å’Œ<code>cd.yml</code>æ–‡ä»¶</p><p>åœ¨<code>ci.yml</code>æ–‡ä»¶ä¸­å†™å…¥ï¼š</p><div class="language-auto"><pre><code>name:Â CI\n\non:\nÂ Â push:\nÂ Â Â Â branches:\nÂ Â Â Â Â Â -Â &#39;**&#39;\nÂ Â pull_request:\nÂ Â Â Â branches:\nÂ Â Â Â Â Â -Â &#39;**&#39;\njobs:\nÂ Â linter:\nÂ Â Â Â runs-on:Â ubuntu-latest\nÂ Â Â Â steps:\nÂ Â Â Â Â Â -Â uses:Â actions/checkout@v2\nÂ Â Â Â Â Â -Â uses:Â actions/setup-node@v2\nÂ Â Â Â Â Â Â Â with:\nÂ Â Â Â Â Â Â Â Â Â node-version:Â 16\nÂ Â Â Â Â Â -Â run:Â npmÂ ci\nÂ Â Â Â Â Â -Â run:Â npmÂ runÂ lint\nÂ Â tests:\nÂ Â Â Â needs:Â linter\nÂ Â Â Â runs-on:Â ubuntu-latest\nÂ Â Â Â steps:\nÂ Â Â Â Â Â -Â uses:Â actions/checkout@v2\nÂ Â Â Â Â Â -Â uses:Â actions/setup-node@v2\nÂ Â Â Â Â Â Â Â with:\nÂ Â Â Â Â Â Â Â Â Â node-version:Â 16\nÂ Â Â Â Â Â -Â run:Â npmÂ ci\nÂ Â Â Â Â Â -Â run:Â npmÂ runÂ test\n\n</code></pre></div><p>ä¸Šé¢é…ç½®å¤§æ¦‚æ„æ€å°±æ˜¯ï¼Œç›‘å¬æ‰€æœ‰åˆ†æ”¯çš„<code>push</code>å’Œ<code>pull_request</code>åŠ¨ä½œï¼Œè‡ªåŠ¨æ‰§è¡Œ<code>linter</code>å’Œ<code>tests</code>ä»»åŠ¡ã€‚</p><p>GithubActions æ›´å¤šç”¨æ³•å‚è€ƒï¼š<a href="http://github.com/features/ac%E2%80%A6" target="_blank" rel="noopener noreferrer">github.com/features/acâ€¦</a></p><p>ç„¶åæ¨é€ä»£ç ï¼ŒéªŒè¯é…ç½®æ˜¯å¦ç”Ÿæ•ˆ</p><div class="language-auto"><pre><code>gitÂ addÂ .\ngitÂ commitÂ -mÂ &#39;ci:Â useÂ githubÂ actions&#39;\ngitÂ push\n</code></pre></div><p>æ­¤æ—¶æ‰“å¼€å½“å‰é¡¹ç›®çš„ <em>Github</em> é¡µé¢ï¼Œç„¶åç‚¹å‡»é¡¶éƒ¨ <em>Actions</em> èœå•å°±ä¼šçœ‹åˆ°æ­£åœ¨è¿›è¡Œçš„ä¸¤ä¸ªä»»åŠ¡ï¼Œä¸€ä¸ªå°†ä¼šæˆåŠŸï¼ˆæµ‹è¯•ï¼‰ï¼Œä¸€ä¸ªå°†ä¼šå¤±è´¥ï¼ˆå‘å¸ƒï¼‰ã€‚</p><p>ä¸Šé¢åªæ˜¯å®ç°äº†ä»£ç è‡ªåŠ¨æµ‹è¯•æµç¨‹ï¼Œä¸‹é¢å®ç°è‡ªåŠ¨å‘å¸ƒçš„æµç¨‹ã€‚</p><p>åœ¨æ­¤ä¹‹å‰éœ€è¦åˆ°NPMç½‘ç«™ä¸Šæ³¨å†Œä¸€ä¸ªè´¦å·ï¼ˆå·²æœ‰å¯å¿½ç•¥ï¼‰ï¼Œå¹¶åˆ›å»ºä¸€ä¸ª<code>package</code>ã€‚</p><p>ç„¶ååˆ›å»º<code>GH_TOKEN</code>å’Œ<code>NPM_TOKEN</code>ï¼ˆæ³¨æ„ï¼Œä¸è¦åœ¨ä»£ç ä¸­åŒ…å«ä»»ä½•çš„ TOKEN ä¿¡æ¯ï¼‰ï¼š</p><ul><li><p>å¦‚ä½•åˆ›å»º GITHUB\\_TOKENï¼ˆåˆ›å»ºæ—¶å‹¾é€‰ <em>repo</em> å’Œ <em>workflow</em> æƒé™ï¼‰</p></li><li><p>å¦‚ä½•åˆ›å»º NPM\\_TOKENï¼ˆåˆ›å»ºæ—¶é€‰ä¸­ <em>Automation</em> æƒé™ï¼‰</p></li></ul><p>å°†åˆ›å»ºå¥½çš„ä¸¤ä¸ª<code>TOKEN</code>æ·»åŠ åˆ°é¡¹ç›®çš„ <em>Actions secrets</em> ä¸­ï¼š</p><p><em>Github é¡¹ç›®é¦–é¡µ</em> -&gt; <em>é¡¶éƒ¨ Settings èœå•</em> -&gt; <em>ä¾§è¾¹æ  Secrets</em></p><p>ç„¶åä¿®æ”¹<code>package.json</code>ä¸­çš„<code>â€œnameâ€</code>ï¼Œ<code>â€œnameâ€</code>å°±æ˜¯ä½ åœ¨NPMä¸Šåˆ›å»ºçš„<code>package</code>çš„åç§°ã€‚</p><p>åœ¨<code>cd.yml</code>æ–‡ä»¶ä¸­å†™å…¥ï¼š</p><div class="language-auto"><pre><code>name:Â CD\n\non:\nÂ Â push:\nÂ Â Â Â branches:\nÂ Â Â Â Â Â -Â main\nÂ Â pull_request:\nÂ Â Â Â branches:\nÂ Â Â Â Â Â -Â main\njobs:\nÂ Â release:\nÂ Â Â Â runs-on:Â ubuntu-latest\nÂ Â Â Â steps:\nÂ Â Â Â Â Â -Â uses:Â actions/checkout@v2\nÂ Â Â Â Â Â -Â uses:Â actions/setup-node@v2\nÂ Â Â Â Â Â Â Â with:\nÂ Â Â Â Â Â Â Â Â Â node-version:Â 16\nÂ Â Â Â Â Â #Â https://github.com/semantic-release/git/issues/209\nÂ Â Â Â Â Â -Â run:Â npmÂ ciÂ --ignore-scripts\nÂ Â Â Â Â Â -Â run:Â npmÂ runÂ build\nÂ Â Â Â Â Â -Â run:Â npxÂ semantic-release\nÂ Â Â Â Â Â Â Â env:\nÂ Â Â Â Â Â Â Â Â Â GH_TOKEN:Â ${{Â secrets.GH_TOKENÂ }}\nÂ Â Â Â Â Â Â Â Â Â NPM_TOKEN:Â ${{Â secrets.NPM_TOKENÂ }}\n</code></pre></div><p>ç”±äºâ€œé»‘å‘½è´µâ€ï¼ŒGithub å·²å°†æ–°é¡¹ç›®çš„é»˜è®¤åˆ†æ”¯åç§°æ›´æ”¹ä¸º <code>â€œmainâ€</code>ï¼Œè¯¦è§ï¼šissuesï¼Œ ä¸ºäº†æ–¹ä¾¿ï¼Œåé¢ç»Ÿä¸€ç§°ä¸º <em>ä¸»åˆ†æ”¯</em></p><p>æ‰€ä»¥å¦‚æœä½ çš„ä¸»åˆ†æ”¯åç§°æ˜¯<code>â€œmainâ€</code>ï¼Œä¸Šé¢çš„<code>branches</code>éœ€è¦ä¿®æ”¹ä¸ºï¼š</p><div class="language-auto"><pre><code>on:\nÂ Â push:\nÂ Â Â Â branches:\nÂ Â Â Â Â Â -Â main\nÂ Â pull_request:\nÂ Â Â Â branches:\nÂ Â Â Â Â Â -Â main\n</code></pre></div><p>ç„¶åå®‰è£…è¯­ä¹‰å‘ç‰ˆä¾èµ–ï¼Œéœ€è¦ç”¨åˆ°<code>semantic-release</code>å’Œå®ƒçš„æ’ä»¶ï¼š</p><ul><li><p>semantic-releaseï¼šè¯­ä¹‰å‘ç‰ˆæ ¸å¿ƒåº“</p></li><li><p>@semantic-release/changelogï¼šç”¨äºè‡ªåŠ¨ç”Ÿæˆ <a href="http://changelog.md" target="_blank" rel="noopener noreferrer">changelog.md</a></p></li><li><p>@semantic-release/gitï¼šç”¨äºå°†å‘å¸ƒæ—¶äº§ç”Ÿçš„æ›´æ”¹æäº¤å›è¿œç¨‹ä»“åº“</p></li></ul><div class="language-auto"><pre><code>npm i semantic-release @semantic-release/changelog @semantic-release/git -D\n</code></pre></div><p>åœ¨é¡¹ç›®æ ¹ç›®å½•æ–°å»ºé…ç½®æ–‡ä»¶<code>.releaserc</code>å¹¶å†™å…¥ï¼š</p><div class="language-auto"><pre><code>{\nÂ Â &quot;branches&quot;:Â [&quot;master&quot;],\nÂ Â &quot;plugins&quot;:Â [\nÂ Â Â Â &quot;@semantic-release/commit-analyzer&quot;,\nÂ Â Â Â &quot;@semantic-release/release-notes-generator&quot;,\nÂ Â Â Â &quot;@semantic-release/changelog&quot;,\nÂ Â Â Â &quot;@semantic-release/github&quot;,\nÂ Â Â Â &quot;@semantic-release/npm&quot;,\nÂ Â Â Â &quot;@semantic-release/git&quot;\nÂ Â ]\n}\n</code></pre></div><p>è¿™é‡ŒåŒæ ·ï¼Œå¦‚æœä½ çš„ä¸»åˆ†æ”¯åç§°æ˜¯<code>â€œmainâ€</code>ï¼Œä¸Šé¢çš„<code>branches</code>éœ€è¦ä¿®æ”¹ä¸ºï¼š</p><div class="language-auto"><pre><code>Â Â &quot;branches&quot;:Â [&quot;+([0-9])?(.{+([0-9]),x}).x&quot;,Â &quot;main&quot;],\n</code></pre></div><p>æœ€åæ–°å»ºåˆ†æ”¯ <em>develop</em> åˆ†æ”¯å¹¶æäº¤å·¥ä½œå†…å®¹ã€‚</p><div class="language-auto"><pre><code>gitÂ checkoutÂ -bÂ develop\ngitÂ addÂ .\ngitÂ commitÂ -mÂ &#39;feat:Â completeÂ theÂ CI/CDÂ workflow&#39;\ngitÂ pushÂ --set-upstreamÂ originÂ develop\ngitÂ push\n</code></pre></div><p>ç„¶åå°† <em>develop</em> åˆ†æ”¯åˆå¹¶åˆ° <em>ä¸»åˆ†æ”¯</em>ï¼Œå¹¶æäº¤ï¼Œæ³¨æ„ï¼šè¿™ä¸ªæäº¤ä¼šè§¦å‘æµ‹è¯•å¹¶ <em>å‘å¸ƒç‰ˆæœ¬</em> (è‡ªåŠ¨åˆ›å»º<code>tag</code>å’Œ<code>changelog</code>)</p><div class="language-auto"><pre><code>gitÂ checkoutÂ master\ngitÂ mergeÂ develop\ngitÂ push\n</code></pre></div><p>å®Œæˆä¸Šé¢æ“ä½œä¹‹åï¼Œæ‰“å¼€ <em>Github é¡¹ç›®ä¸»é¡µ</em> å’Œ <em>NPM é¡¹ç›®ä¸»é¡µ</em> å¯ä»¥çœ‹åˆ°ä¸€ä¸ª <em>Release</em> çš„æ›´æ–°è®°å½•ã€‚</p><p>æœ€ååˆ‡å›åˆ° <em>develop</em> åˆ†æ”¯ï¼Œåˆ›å»ºä¸€ä¸ªè‡ªåŠ¨æ›´æ–°ä¾èµ–çš„<code>workflow</code>ã€‚</p><p>åœ¨<code>.github</code>æ–‡ä»¶å¤¹ä¸­åˆ›å»º<code>dependabot.yml</code>æ–‡ä»¶ï¼Œå¹¶å†™å…¥å†…å®¹ï¼š</p><div class="language-auto"><pre><code>version:Â 2\nupdates:\nÂ Â #Â EnableÂ versionÂ updatesÂ forÂ npm\nÂ Â -Â package-ecosystem:Â &#39;npm&#39;\nÂ Â Â Â #Â LookÂ forÂ `package.json`Â andÂ `lock`Â filesÂ inÂ theÂ `root`Â directory\nÂ Â Â Â directory:Â &#39;/&#39;\nÂ Â Â Â #Â CheckÂ theÂ npmÂ registryÂ forÂ updatesÂ everyÂ dayÂ (weekdays)\nÂ Â Â Â schedule:\nÂ Â Â Â Â Â interval:Â &#39;weekly&#39;\n</code></pre></div><p>æäº¤å¹¶æŸ¥çœ‹ <em>workflows</em> æ˜¯å¦å…¨éƒ¨é€šè¿‡ï¼Œå†åˆå¹¶åˆ° <em>ä¸»åˆ†æ”¯</em> å¹¶æäº¤ï¼Œè¿™ä¸ªæäº¤ä¸ä¼šè§¦å‘ç‰ˆæœ¬å‘å¸ƒã€‚</p><div class="language-auto"><pre><code>gitÂ pullÂ originÂ master\ngitÂ addÂ .\ngitÂ commitÂ -mÂ &#39;ci:Â addÂ dependabot&#39;\ngitÂ pushÂ \n\ngitÂ checkoutÂ master\ngitÂ mergeÂ develop\ngitÂ push\n</code></pre></div><p>è§¦å‘ç‰ˆæœ¬å‘å¸ƒéœ€è¦ä¸¤ä¸ªæ¡ä»¶ï¼š</p><ol><li><p>åªæœ‰å½“<code>push</code>å’Œ<code>pull_request</code>åˆ° <em>ä¸»åˆ†æ”¯</em> ä¸Šæ‰ä¼šè§¦å‘ç‰ˆæœ¬å‘å¸ƒ</p></li><li><p>åªæœ‰<code>commit</code>å‰ç¼€ä¸º<code>feat</code>ã€<code>fix</code>ã€<code>perf</code>æ‰ä¼šå‘å¸ƒï¼Œå¦åˆ™è·³è¿‡ã€‚</p></li></ol><p>æ›´å¤šå‘å¸ƒè§„åˆ™ï¼Œè¯¦è§ï¼š<a href="http://github.com/semantic-re%E2%80%A6" target="_blank" rel="noopener noreferrer">github.com/semantic-reâ€¦</a></p><p>SemanticRelease ä½¿ç”¨æ–¹å¼ï¼Œè¯¦è§ï¼š<a href="http://semantic-release.gitbook.io" target="_blank" rel="noopener noreferrer">semantic-release.gitbook.io</a></p><p><strong>å¦‚æœä½ èƒ½æ­£ç¡®é…ç½®ä¸Šé¢æ‰€æœ‰æ­¥éª¤ï¼Œå¹¶æˆåŠŸå‘å¸ƒï¼Œé‚£ä¹ˆæ­å–œä½ ï¼ä½ æ‹¥æœ‰äº†ä¸€ä¸ªå®Œå…¨è‡ªåŠ¨åŒ–çš„é¡¹ç›®ï¼Œå®ƒæ‹¥æœ‰ï¼šè‡ªåŠ¨ä¾èµ–æ›´æ–°ã€æµ‹è¯•ã€å‘å¸ƒï¼Œå’Œè‡ªåŠ¨ç”Ÿæˆç‰ˆæœ¬ä¿¡æ¯ç­‰åŠŸèƒ½ã€‚</strong></p><p>å®Œæ•´çš„é¡¹ç›®ç¤ºä¾‹ï¼š@resreq/event-hub</p><h2 id="ç»“è¯­">ç»“è¯­</h2><p>æœ¬æ–‡æœªæ¶‰åŠåˆ°ï¼šç»„ä»¶åº“ã€Monorepoã€Jenkins CI ç­‰é…ç½®ï¼Œä½†èƒ½è¦†ç›–ç»å¤§éƒ¨å‰ç«¯é¡¹ç›® CI/CD æµç¨‹ã€‚</p><p>æœ‰äº›åœ°æ–¹è®²å¾—æ¯”è¾ƒç»†ï¼Œç”šè‡³æœ‰äº›å•°å—¦ï¼Œä½†è¿˜æ˜¯å¸Œæœ›èƒ½å¸®åŠ©åˆ°å¤§å®¶ï¼æ’’èŠ±ï¼ğŸ‰ğŸ‰ğŸ‰</p><p><img src="https://qn.huat.xyz/mac/20220716185154.png" alt=""></p><p><strong>ç¨‹åºå‘˜æˆé•¿æŒ‡åŒ—</strong></p><p>ä¸“æ³¨ Node.js æŠ€æœ¯æ ˆåˆ†äº«ï¼Œä» å‰ç«¯ åˆ° Node.js å†åˆ° åç«¯æ•°æ®åº“ï¼Œç¥æ‚¨æˆä¸ºä¼˜ç§€çš„é«˜çº§ Node.js å…¨æ ˆå·¥ç¨‹å¸ˆã€‚ä¸€ä¸ªæœ‰è¶£çš„ä¸”ä¹äºåˆ†äº«çš„äººã€‚åº§å³é“­ï¼šä»Šå¤©æœªå®Œæˆçš„ï¼Œæ˜å¤©æ›´ä¸ä¼šå®Œæˆã€‚</p><p>94ç¯‡åŸåˆ›å†…å®¹</p><p>å…¬ä¼—å·</p><p>Node ç¤¾ç¾¤</p><p>æˆ‘ç»„å»ºäº†ä¸€ä¸ªæ°›å›´ç‰¹åˆ«å¥½çš„ Node.js ç¤¾ç¾¤ï¼Œé‡Œé¢æœ‰å¾ˆå¤š Node.jså°ä¼™ä¼´ï¼Œå¦‚æœä½ å¯¹Node.jså­¦ä¹ æ„Ÿå…´è¶£çš„è¯ï¼ˆåç»­æœ‰è®¡åˆ’ä¹Ÿå¯ä»¥ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥ä¸€èµ·è¿›è¡ŒNode.jsç›¸å…³çš„äº¤æµã€å­¦ä¹ ã€å…±å»ºã€‚ä¸‹æ–¹åŠ  è€ƒæ‹‰ å¥½å‹å›å¤ã€ŒNodeã€å³å¯ã€‚</p>',208)];c.render=function(t,n,c,s,i,p){return e(),o("div",null,d)};export default c;export{n as __pageData};
